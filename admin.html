<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –°—É–±–∞—Ä–µ–Ω–¥–∞–ú–∏–Ω—Å–∫</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            color: #333;
        }

        .header {
            background: #2c3e50;
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .admin-nav {
            display: flex;
            gap: 2rem;
        }

        .admin-nav a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background 0.3s;
        }

        .admin-nav a:hover,
        .admin-nav a.active {
            background: #34495e;
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 2rem;
            color: #2c3e50;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .tabs-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .tabs-header {
            display: flex;
            background: #ecf0f1;
            border-bottom: 1px solid #ddd;
        }

        .tab-button {
            padding: 1rem 2rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: #7f8c8d;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab-button.active {
            background: white;
            color: #2c3e50;
            border-bottom-color: #3498db;
        }

        .tab-button:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .tab-content {
            display: none;
            padding: 2rem;
        }

        .tab-content.active {
            display: block;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-title {
            font-size: 1.3rem;
            color: #2c3e50;
        }

        .filter-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .status-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-pending {
            background: #f39c12;
            color: white;
        }

        .status-available {
            background: #27ae60;
            color: white;
        }

        .status-booked {
            background: #e74c3c;
            color: white;
        }

        .status-completed {
            background: #27ae60;
            color: white;
        }

        .status-cancelled {
            background: #e74c3c;
            color: white;
        }

        .status-rejected {
            background: #95a5a6;
            color: white;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-warning {
            background: #f39c12;
            color: white;
        }

        .btn:hover {
            opacity: 0.8;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #7f8c8d;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #7f8c8d;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .pagination button {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
        }

        .pagination button.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .pagination button:hover {
            background: #f8f9fa;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #ecf0f1;
        }

        .detail-label {
            font-weight: 600;
            color: #2c3e50;
        }

        .detail-value {
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üè† –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –°—É–±–∞—Ä–µ–Ω–¥–∞–ú–∏–Ω—Å–∫</div>
        <div class="admin-nav">
            <a href="main.html">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
            <a href="#" onclick="logout()">–í—ã–π—Ç–∏</a>
        </div>
    </div>

    <div class="container">
        <h1 class="page-title">üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="total-apartments">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ –∫–≤–∞—Ä—Ç–∏—Ä</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pending-apartments">0</div>
                <div class="stat-label">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-users">0</div>
                <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-bookings">0</div>
                <div class="stat-label">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-payments">0</div>
                <div class="stat-label">–ü–ª–∞—Ç–µ–∂–µ–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-revenue">0.00</div>
                <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥ (BYN)</div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs-container">
            <div class="tabs-header">
                <button class="tab-button active" onclick="showTab('apartments')">üè† –ö–≤–∞—Ä—Ç–∏—Ä—ã</button>
                <button class="tab-button" onclick="showTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
                <button class="tab-button" onclick="showTab('bookings')">üìÖ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</button>
                <button class="tab-button" onclick="showTab('payments')">üí∞ –ü–ª–∞—Ç–µ–∂–∏</button>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ö–≤–∞—Ä—Ç–∏—Ä—ã -->
            <div id="apartments-tab" class="tab-content active">
                <div class="section-header">
                    <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä–∞–º–∏</h2>
                    <div class="filter-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É..." onkeyup="filterApartments()">
                        <select class="filter-select" onchange="filterApartments()">
                            <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="pending">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</option>
                            <option value="available">–û–¥–æ–±—Ä–µ–Ω–Ω—ã–µ</option>
                            <option value="booked">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</option>
                            <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                <div id="apartments-content">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä...</div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
            <div id="users-tab" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                    <div class="filter-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email..." onkeyup="filterUsers()">
                        <select class="filter-select" onchange="filterUsers()">
                            <option value="all">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                            <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                            <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                <div id="users-content">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div id="bookings-tab" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏</h2>
                    <div class="filter-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª–∏–µ–Ω—Ç—É..." onkeyup="filterBookings()">
                        <select class="filter-select" onchange="filterBookings()">
                            <option value="all">–í—Å–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</option>
                            <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                <div id="bookings-content">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π...</div>
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –ü–ª–∞—Ç–µ–∂–∏ -->
            <div id="payments-tab" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞–º–∏</h2>
                    <div class="filter-controls">
                        <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–ª–∏–µ–Ω—Ç—É..." onkeyup="filterPayments()">
                        <select class="filter-select" onchange="filterPayments()">
                            <option value="all">–í—Å–µ –ø–ª–∞—Ç–µ–∂–∏</option>
                            <option value="pending">–û–∂–∏–¥–∞—é—â–∏–µ</option>
                            <option value="completed">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                    </div>
                </div>
                <div id="payments-content">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <script>
        let currentTab = 'apartments';
        let apartments = [];
        let users = [];
        let bookings = [];
        let payments = [];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            checkAdminAccess();
        });

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function checkAdminAccess() {
            fetch('api.php?action=check_admin')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    loadStatistics();
                    loadApartments();
                } else {
                    alert('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω! –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.');
                    window.location.href = 'admin-login.html';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞:', error);
                window.location.href = 'admin-login.html';
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function showTab(tabName) {
            currentTab = tabName;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            switch(tabName) {
                case 'apartments':
                    loadApartments();
                    break;
                case 'users':
                    loadUsers();
                    break;
                case 'bookings':
                    loadBookings();
                    break;
                case 'payments':
                    loadPayments();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function loadStatistics() {
            Promise.all([
                fetch('api.php?action=get_apartments'),
                fetch('api.php?action=get_users'),
                fetch('api.php?action=get_bookings'),
                fetch('api.php?action=get_payments')
            ])
            .then(responses => Promise.all(responses.map(r => r.json())))
            .then(([apartmentsData, usersData, bookingsData, paymentsData]) => {
                if (apartmentsData.success) {
                    apartments = apartmentsData.data;
                    document.getElementById('total-apartments').textContent = apartments.length;
                    document.getElementById('pending-apartments').textContent = 
                        apartments.filter(apt => apt.status === 'pending').length;
                }
                
                if (usersData.success) {
                    users = usersData.data;
                    document.getElementById('total-users').textContent = users.length;
                }

                if (bookingsData.success) {
                    bookings = bookingsData.data;
                    document.getElementById('total-bookings').textContent = bookings.length;
                }

                if (paymentsData.success) {
                    payments = paymentsData.data;
                    document.getElementById('total-payments').textContent = payments.length;
                    const totalRevenue = payments
                        .filter(payment => payment.status === 'completed')
                        .reduce((sum, payment) => sum + parseFloat(payment.amount), 0);
                    document.getElementById('total-revenue').textContent = totalRevenue.toFixed(2);
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä
        function loadApartments() {
            fetch('api.php?action=get_apartments')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    apartments = data.data;
                    displayApartments(apartments);
                } else {
                    document.getElementById('apartments-content').innerHTML = 
                        '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä</div>';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä:', error);
                document.getElementById('apartments-content').innerHTML = 
                    '<div class="empty-state">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function loadUsers() {
            fetch('api.php?action=get_users')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    users = data.data;
                    displayUsers(users);
                } else {
                    document.getElementById('users-content').innerHTML = 
                        '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
                document.getElementById('users-content').innerHTML = 
                    '<div class="empty-state">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            });
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function deleteUser(userId, userName) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "${userName}"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.`)) {
                return;
            }
            
            fetch('api.php?action=delete_user', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    user_id: userId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!');
                    loadUsers(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    loadStatistics(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
        function loadBookings() {
            fetch('api.php?action=get_bookings')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    bookings = data.data;
                    displayBookings(bookings);
                } else {
                    document.getElementById('bookings-content').innerHTML = 
                        '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</div>';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π:', error);
                document.getElementById('bookings-content').innerHTML = 
                    '<div class="empty-state">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
        function loadPayments() {
            fetch('api.php?action=get_payments')
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    payments = data.data;
                    displayPayments(payments);
                } else {
                    document.getElementById('payments-content').innerHTML = 
                        '<div class="empty-state">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π</div>';
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:', error);
                document.getElementById('payments-content').innerHTML = 
                    '<div class="empty-state">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º</div>';
            });
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–≤–∞—Ä—Ç–∏—Ä
        function displayApartments(apartmentsList) {
            const container = document.getElementById('apartments-content');
            
            if (apartmentsList.length === 0) {
                container.innerHTML = '<div class="empty-state">–ö–≤–∞—Ä—Ç–∏—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            const table = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                            <th>–ê–¥—Ä–µ—Å</th>
                            <th>–¶–µ–Ω–∞</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${apartmentsList.map(apartment => `
                            <tr>
                                <td>${apartment.title}</td>
                                <td>${apartment.address}, ${apartment.district}</td>
                                <td>${apartment.price} BYN</td>
                                <td><span class="status-badge status-${apartment.status}">${getStatusText(apartment.status)}</span></td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewDetails('apartment', ${apartment.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                                    ${apartment.status === 'pending' ? `
                                        <button class="btn btn-success" onclick="updateApartmentStatus(${apartment.id}, 'available')">–û–¥–æ–±—Ä–∏—Ç—å</button>
                                        <button class="btn btn-danger" onclick="updateApartmentStatus(${apartment.id}, 'rejected')">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
                                    ` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            container.innerHTML = table;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function displayUsers(usersList) {
            const container = document.getElementById('users-content');
            
            if (usersList.length === 0) {
                container.innerHTML = '<div class="empty-state">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            const table = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–ò–º—è</th>
                            <th>Email</th>
                            <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                            <th>–†–æ–ª—å</th>
                            <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${usersList.map(user => `
                            <tr>
                                <td>${user.name} ${user.surname || ''}</td>
                                <td>${user.email}</td>
                                <td>${user.phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}</td>
                                <td><span class="status-badge ${user.role === 'admin' ? 'status-completed' : 'status-pending'}">${user.role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span></td>
                                <td>${formatDate(user.created_at)}</td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewDetails('user', ${user.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                                    ${user.role !== 'admin' ? `
                                        <button class="btn btn-danger" onclick="deleteUser(${user.id}, '${user.name}')">–£–¥–∞–ª–∏—Ç—å</button>
                                    ` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            container.innerHTML = table;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
        function displayBookings(bookingsList) {
            const container = document.getElementById('bookings-content');
            
            if (bookingsList.length === 0) {
                container.innerHTML = '<div class="empty-state">–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            const table = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>–ö–ª–∏–µ–Ω—Ç</th>
                            <th>–ö–≤–∞—Ä—Ç–∏—Ä–∞</th>
                            <th>–î–∞—Ç—ã</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${bookingsList.map(booking => `
                            <tr>
                                <td>${booking.name}</td>
                                <td>${booking.apartment_title || '–ö–≤–∞—Ä—Ç–∏—Ä–∞'}</td>
                                <td>${formatDate(booking.check_in)} - ${formatDate(booking.check_out)}</td>
                                <td>${booking.total_amount} BYN</td>
                                <td><span class="status-badge status-${booking.status}">${getBookingStatusText(booking.status)}</span></td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewDetails('booking', ${booking.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                                    ${booking.status === 'active' ? `
                                        <button class="btn btn-success" onclick="updateBookingStatus(${booking.id}, 'completed')">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                                        <button class="btn btn-danger" onclick="updateBookingStatus(${booking.id}, 'cancelled')">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                                    ` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            container.innerHTML = table;
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
        function displayPayments(paymentsList) {
            const container = document.getElementById('payments-content');
            
            if (paymentsList.length === 0) {
                container.innerHTML = '<div class="empty-state">–ü–ª–∞—Ç–µ–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            const table = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ö–ª–∏–µ–Ω—Ç</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–°–ø–æ—Å–æ–±</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${paymentsList.map(payment => `
                            <tr>
                                <td>#${payment.id}</td>
                                <td>${payment.client_name || '–ö–ª–∏–µ–Ω—Ç'}</td>
                                <td>${payment.amount} ${payment.currency}</td>
                                <td>${getPaymentMethodText(payment.method)}</td>
                                <td><span class="status-badge status-${payment.status}">${getPaymentStatusText(payment.status)}</span></td>
                                <td>${formatDate(payment.created_at)}</td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewDetails('payment', ${payment.id})">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                                    ${payment.status === 'pending' ? `
                                        <button class="btn btn-success" onclick="updatePaymentStatus(${payment.id}, 'completed')">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                                        <button class="btn btn-danger" onclick="updatePaymentStatus(${payment.id}, 'cancelled')">–û—Ç–º–µ–Ω–∏—Ç—å</button>
                                    ` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            
            container.innerHTML = table;
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–≤–∞—Ä—Ç–∏—Ä
        function filterApartments() {
            const searchTerm = document.querySelector('#apartments-tab .search-input').value.toLowerCase();
            const statusFilter = document.querySelector('#apartments-tab .filter-select').value;
            
            let filtered = apartments;
            
            if (searchTerm) {
                filtered = filtered.filter(apt => 
                    apt.title.toLowerCase().includes(searchTerm) ||
                    apt.address.toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter !== 'all') {
                filtered = filtered.filter(apt => apt.status === statusFilter);
            }
            
            displayApartments(filtered);
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function filterUsers() {
            const searchTerm = document.querySelector('#users-tab .search-input').value.toLowerCase();
            const statusFilter = document.querySelector('#users-tab .filter-select').value;
            
            let filtered = users;
            
            if (searchTerm) {
                filtered = filtered.filter(user => 
                    user.name.toLowerCase().includes(searchTerm) ||
                    user.email.toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter !== 'all') {
                filtered = filtered.filter(user => user.status === statusFilter);
            }
            
            displayUsers(filtered);
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
        function filterBookings() {
            const searchTerm = document.querySelector('#bookings-tab .search-input').value.toLowerCase();
            const statusFilter = document.querySelector('#bookings-tab .filter-select').value;
            
            let filtered = bookings;
            
            if (searchTerm) {
                filtered = filtered.filter(booking => 
                    booking.name.toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter !== 'all') {
                filtered = filtered.filter(booking => booking.status === statusFilter);
            }
            
            displayBookings(filtered);
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
        function filterPayments() {
            const searchTerm = document.querySelector('#payments-tab .search-input').value.toLowerCase();
            const statusFilter = document.querySelector('#payments-tab .filter-select').value;
            
            let filtered = payments;
            
            if (searchTerm) {
                filtered = filtered.filter(payment => 
                    (payment.client_name || '').toLowerCase().includes(searchTerm)
                );
            }
            
            if (statusFilter !== 'all') {
                filtered = filtered.filter(payment => payment.status === statusFilter);
            }
            
            displayPayments(filtered);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã
        function updateApartmentStatus(apartmentId, newStatus) {
            const statusText = newStatus === 'available' ? '–æ–¥–æ–±—Ä–∏—Ç—å' : '–æ—Ç–∫–ª–æ–Ω–∏—Ç—å';
            
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ ${statusText} —ç—Ç—É –∫–≤–∞—Ä—Ç–∏—Ä—É?`)) {
                return;
            }

            fetch('api.php?action=update_apartment_status', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    apartment_id: apartmentId,
                    status: newStatus
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(newStatus === 'available' ? '‚úÖ –ö–≤–∞—Ä—Ç–∏—Ä–∞ –æ–¥–æ–±—Ä–µ–Ω–∞!' : '‚ùå –ö–≤–∞—Ä—Ç–∏—Ä–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.');
                    loadApartments();
                    loadStatistics();
                } else {
                    alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        function updateBookingStatus(bookingId, newStatus) {
            const statusText = newStatus === 'completed' ? '–∑–∞–≤–µ—Ä—à–∏—Ç—å' : '–æ—Ç–º–µ–Ω–∏—Ç—å';
            
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ ${statusText} —ç—Ç–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ?`)) {
                return;
            }

            fetch('api.php?action=update_booking_status', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    booking_id: bookingId,
                    status: newStatus
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(newStatus === 'completed' ? '‚úÖ –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!' : '‚ùå –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ.');
                    loadBookings();
                    loadStatistics();
                } else {
                    alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
        function updatePaymentStatus(paymentId, newStatus) {
            const statusText = newStatus === 'completed' ? '–ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å' : '–æ—Ç–º–µ–Ω–∏—Ç—å';
            
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ ${statusText} —ç—Ç–æ—Ç –ø–ª–∞—Ç–µ–∂?`)) {
                return;
            }

            fetch('api.php?action=update_payment_status', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    payment_id: paymentId,
                    status: newStatus
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(newStatus === 'completed' ? '‚úÖ –ü–ª–∞—Ç–µ–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!' : '‚ùå –ü–ª–∞—Ç–µ–∂ –æ—Ç–º–µ–Ω–µ–Ω.');
                    loadPayments();
                    loadStatistics();
                } else {
                    alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            });
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function deleteUser(userId, userName) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è "${userName}"? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.`)) {
                return;
            }

            fetch('api.php?action=delete_user', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    user_id: userId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω!');
                    loadUsers(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    loadStatistics(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                } else {
                    alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ' + (data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º');
            });
        }

        // –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π
        function viewDetails(type, id) {
            let item;
            let content = '';

            switch(type) {
                case 'apartment':
                    item = apartments.find(apt => apt.id == id);
                    if (item) {
                        content = `
                            <h2>–î–µ—Ç–∞–ª–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã</h2>
                            <div class="detail-row">
                                <span class="detail-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</span>
                                <span class="detail-value">${item.title}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–ê–¥—Ä–µ—Å:</span>
                                <span class="detail-value">${item.address}, ${item.district}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–ö–æ–º–Ω–∞—Ç—ã:</span>
                                <span class="detail-value">${item.rooms}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–≠—Ç–∞–∂:</span>
                                <span class="detail-value">${item.floor}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–ü–ª–æ—â–∞–¥—å:</span>
                                <span class="detail-value">${item.area} –º¬≤</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–¶–µ–Ω–∞:</span>
                                <span class="detail-value">${item.price} BYN</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                                <span class="detail-value">${getStatusText(item.status)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–û–ø–∏—Å–∞–Ω–∏–µ:</span>
                                <span class="detail-value">${item.description}</span>
                            </div>
                        `;
                    }
                    break;
                case 'user':
                    item = users.find(user => user.id == id);
                    if (item) {
                        content = `
                            <h2>–î–µ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                            <div class="detail-row">
                                <span class="detail-label">–ò–º—è:</span>
                                <span class="detail-value">${item.name} ${item.surname || ''}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Email:</span>
                                <span class="detail-value">${item.email}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–¢–µ–ª–µ—Ñ–æ–Ω:</span>
                                <span class="detail-value">${item.phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–†–æ–ª—å:</span>
                                <span class="detail-value">${item.role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</span>
                                <span class="detail-value">${formatDate(item.created_at)}</span>
                            </div>
                        `;
                    }
                    break;
                case 'booking':
                    item = bookings.find(booking => booking.id == id);
                    if (item) {
                        content = `
                            <h2>–î–µ—Ç–∞–ª–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
                            <div class="detail-row">
                                <span class="detail-label">–ö–ª–∏–µ–Ω—Ç:</span>
                                <span class="detail-value">${item.name}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–ö–≤–∞—Ä—Ç–∏—Ä–∞:</span>
                                <span class="detail-value">${item.apartment_title || '–ö–≤–∞—Ä—Ç–∏—Ä–∞'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–î–∞—Ç–∞ –∑–∞–µ–∑–¥–∞:</span>
                                <span class="detail-value">${formatDate(item.check_in)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞:</span>
                                <span class="detail-value">${formatDate(item.check_out)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°—É–º–º–∞:</span>
                                <span class="detail-value">${item.total_amount} BYN</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                                <span class="detail-value">${getBookingStatusText(item.status)}</span>
                            </div>
                        `;
                    }
                    break;
                case 'payment':
                    item = payments.find(payment => payment.id == id);
                    if (item) {
                        content = `
                            <h2>–î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞</h2>
                            <div class="detail-row">
                                <span class="detail-label">ID –ø–ª–∞—Ç–µ–∂–∞:</span>
                                <span class="detail-value">#${item.id}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–ö–ª–∏–µ–Ω—Ç:</span>
                                <span class="detail-value">${item.client_name || '–ö–ª–∏–µ–Ω—Ç'}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°—É–º–º–∞:</span>
                                <span class="detail-value">${item.amount} ${item.currency}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</span>
                                <span class="detail-value">${getPaymentMethodText(item.method)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–°—Ç–∞—Ç—É—Å:</span>
                                <span class="detail-value">${getPaymentStatusText(item.status)}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</span>
                                <span class="detail-value">${formatDate(item.created_at)}</span>
                            </div>
                        `;
                    }
                    break;
            }

            if (content) {
                document.getElementById('modal-content').innerHTML = content;
                document.getElementById('details-modal').style.display = 'block';
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal() {
            document.getElementById('details-modal').style.display = 'none';
        }

        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        function logout() {
            fetch('api.php?action=logout', {
                method: 'POST'
            })
            .then(() => {
                window.location.href = 'admin-login.html';
            })
            .catch(error => {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
                window.location.href = 'admin-login.html';
            });
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getStatusText(status) {
            const statusTexts = {
                'pending': '–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏',
                'available': '–î–æ—Å—Ç—É–ø–Ω–∞',
                'booked': '–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∞',
                'rejected': '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞'
            };
            return statusTexts[status] || status;
        }

        function getBookingStatusText(status) {
            const statusTexts = {
                'active': '–ê–∫—Ç–∏–≤–Ω–æ–µ',
                'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω–æ'
            };
            return statusTexts[status] || status;
        }

        function getPaymentStatusText(status) {
            const statusTexts = {
                'pending': '–û–∂–∏–¥–∞–µ—Ç',
                'completed': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω',
                'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
            };
            return statusTexts[status] || status;
        }

        function getPaymentMethodText(method) {
            const methodTexts = {
                'bank-transfer': '–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥',
                'erip': '–ï–†–ò–ü',
                'card': '–û–Ω–ª–∞–π–Ω-–ø–ª–∞—Ç–µ–∂'
            };
            return methodTexts[method] || method;
        }

        function formatDate(dateString) {
            if (!dateString) return '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('details-modal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>